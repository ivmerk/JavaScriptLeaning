<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        function xml2json(xml) {
          try {
            var obj = {};
            if (xml.children.length > 0) {
              for (var i = 0; i < xml.children.length; i++) {
                var item = xml.children.item(i);
                var nodeName = item.nodeName;
            
                if (typeof (obj[nodeName]) == "undefined") {
                  obj[nodeName] = xml2json(item);
                } else {
                  if (typeof (obj[nodeName].push) == "undefined") {
                    var old = obj[nodeName];
                
                    obj[nodeName] = [];
                    obj[nodeName].push(old);
                  }
                  obj[nodeName].push(xml2json(item));
                }
              }
            } else {
              obj = xml.textContent;
            }
            return obj;
          } catch (e) {
              console.log(e.message);
          }
        }        



        let numberOfOrder = '23';
        let numberOfTable = '';
        let orderCategory = '';
        let nameOfWaiter = '';
        let menuXmlRequest = '<RK7Query> <RK7CMD CMD="GetOrderMenu" Order="'+numberOfOrder+' Waiter="'+nameOfWaiter+'" Table="'+numberOfTable+'" OrderCategory="'+orderCategory+'" > <Station code="1"/> </RK7CMD> </RK7Query>';
        let menuXmlAnswer = '';
        let menuXmlAnswerReserved = '<RK7QueryResult ServerVersion="7.6.0.81" XmlVersion="243" NetName="CONF_MIDSERVER" Status="Ok" CMD="GetOrderMenu" ErrorText="" DateTime="2019-12-30T11:37:25" WorkTime="0" Processed="1"> <PriceScale id="3" code="1" name="Основная"/> <TradeGroup id="7" code="1" name="По умолчанию"/> <Dishes> <Item Ident="1000189" Price="100" quantity="3000"/> <Item Ident="1000193" Price="100" quantity="2000"/> <Item Ident="1000338" Price="100"/> </Dishes> <Modifiers> <Item Ident="2003" ID="2003" Price="0"/> <Item Ident="1000378" ID="1000378" Price="0"/> </Modifiers> </RK7QueryResult>';
        
        let sampleObj = {};
        sampleObj = xml2json(menuXmlAnswerReserved);
        let xhr = new XMLHttpRequest();

        xhr.open('GET', 'xml/answer.xml', true);
//        xhr.responseType = 'document';
        xhr.send(); //отправляем запрос на R-keeper
        xhr.onload = function(){
            if(xhr.status != 200){
                console.log(`Ошибка  ${xhr.status}: ${xhr.statusText}`);
                menuXmlAnswer = menuXmlAnswerReserved;
                return
            } else {
                menuXmlAnswer = xhr.response; //ответ из R-keeper в XML
            };
        
        };

        xhr.onprogress = function(event) {
        if (event.lengthComputable) {
        console.log(`Получено ${event.loaded} из ${event.total} байт`);
            } else {
        console.log(`Получено ${event.loaded} байт`); 
        };
    };

        xhr.onerror = function() {
          console.log("Запрос не удался");
    };
    </script>
</body>
</html>